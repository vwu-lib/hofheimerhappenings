---
layout: json_index
---
[
{% for post in site.posts %}
  {%- comment -%}
    Normalize text for comparison:
    - clean_content → full post body as plain text
    - explicit_excerpt → the excerpt Jekyll generates (respects <!--more-->)
  {%- endcomment -%}

  {%- assign clean_content = post.content | strip_html | strip_newlines -%}
  {%- assign explicit_excerpt = post.excerpt | strip_html | strip_newlines -%}

  {%- comment -%}
    Determine which source to use as the excerpt:

    Priority:
    1. front matter "summary" (Option C)
    2. post.excerpt if <!--more--> was used (Option A)
    3. else the cleaned full content (Option B fallback)
  {%- endcomment -%}

  {%- if post.summary -%}
    {%- assign excerpt_source = post.summary -%}

  {%- elsif explicit_excerpt != "" and explicit_excerpt != clean_content -%}
    {%- assign excerpt_source = explicit_excerpt -%}

  {%- else -%}
    {%- assign excerpt_source = clean_content -%}

  {%- endif -%}

  {%- comment -%}
    Final excerpt processing:
    - strip HTML fully → ensures safe, uniform carousel text
    - strip newlines
    - truncate to max 40 words (adjust as desired)
